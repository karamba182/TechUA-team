on:
  push:
  pull_request:
    types: [opened, reopened, closed]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Telegram notification
        run: |
          if [[ "${{ github.event_name }}" == "push" ]]; then
            curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -d chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d text="üöÄ ${{ github.actor }} –∑—Ä–æ–±–∏–≤ –∞–ø–¥–µ–π—Ç —ñ –∑–∞–ø—É—à–∏–≤ –∑–º—ñ–Ω–∏ –≤ ${{ github.repository }}. –ì–ª—è–Ω—å —â–æ —Ç–∞–º: ${{ github.server_url }}/${{ github.repository }}/commit/${{ github.sha }}"
          elif [[ "${{ github.event_name }}" == "pull_request" && "${{ github.event.action }}" == "opened" ]]; then
            curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -d chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d text="üîî ${{ github.actor }} —Å—Ç–≤–æ—Ä–∏–≤ Pull Request –≤ ${{ github.base_ref || 'dev' }}. –ë—É–¥—å –ª–∞—Å–∫–∞, –∑—Ä–æ–±–∏ –∞–ø—Ä—É–≤: ${{ github.server_url }}/${{ github.repository }}/pull/${{ github.event.pull_request.number }}"
          elif [[ "${{ github.event_name }}" == "pull_request" && "${{ github.event.action }}" == "closed" && "${{ github.event.pull_request.merged }}" == "true" ]]; then
            curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -d chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d text="‚úÖ ${{ github.actor }} –∑–º–µ—Ä–¥–∂–∏–≤ Pull Request –≤ ${{ github.base_ref || 'dev' }}: ${{ github.server_url }}/${{ github.repository }}/pull/${{ github.event.pull_request.number }}"
          fi
